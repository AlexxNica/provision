!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},a={},n={},s={}.hasOwnProperty,c=/^\.\.?(\/|$)/,r=function(e,t){for(var a,n=[],s=(c.test(t)?e+"/"+t:t).split("/"),r=0,o=s.length;r<o;r++)a=s[r],".."===a?n.pop():"."!==a&&""!==a&&n.push(a);return n.join("/")},o=function(e){return e.split("/").slice(0,-1).join("/")},i=function(t){return function(a){var n=r(o(t),a);return e.require(n,t)}},l=function(e,t){var n=f&&f.createHot(e),s={id:e,exports:{},hot:n};return a[e]=s,t(s.exports,i(e),s),s.exports},u=function(e){return n[e]?u(n[e]):e},p=function(e,t){return u(r(o(e),t))},m=function(e,n){null==n&&(n="/");var c=u(e);if(s.call(a,c))return a[c].exports;if(s.call(t,c))return l(c,t[c]);throw new Error("Cannot find module '"+e+"' from '"+n+"'")};m.alias=function(e,t){n[t]=e};var d=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/,v=function(e){if(d.test(e)){var t=e.replace(d,"");s.call(n,t)&&n[t].replace(d,"")!==t+"/index"||(n[t]=e)}if(h.test(e)){var a=e.replace(h,"");s.call(n,a)||(n[a]=e)}};m.register=m.define=function(e,n){if(e&&"object"==typeof e)for(var c in e)s.call(e,c)&&m.register(c,e[c]);else t[e]=n,delete a[e],v(e)},m.list=function(){var e=[];for(var a in t)s.call(t,a)&&e.push(a);return e};var f=e._hmr&&new e._hmr(p,m,t,a);m._cache=a,m.hmr=f&&f.wrap,m.brunch=!0,e.require=m}}(),function(){"undefined"==typeof window?this:window;require.register("render.jsx",function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){var t=e.target;$(t).hasClass("rotate")||$(t).addClass("rotate"),t.rotateTimeout&&clearTimeout(t.rotateTimeout),t.rotateTimeout=setTimeout(function(){$(t).removeClass("rotate")},500)}var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.toggleExpand=a.toggleExpand.bind(a),a.handleChange=a.handleChange.bind(a),a.handleOptionChange=a.handleOptionChange.bind(a),a.update=a.update.bind(a),a.remove=a.remove.bind(a),a}return c(t,e),o(t,[{key:"toggleExpand",value:function(){var e=this.props.subnet;e._expand=!e._expand,this.props.change(this.props.index,e)}},{key:"getCodeName",value:function(e){var t={1:"Subnet Mask",3:"Default Gateway",6:"DNS Server",15:"Domain Name",28:"Broadcast",42:"NTP Server",67:"Bootfile Name"};return t[e]||"Code "+e}},{key:"update",value:function(){this.props.update(this.props.index)}},{key:"remove",value:function(){this.props.remove(this.props.index)}},{key:"handleChange",value:function(e){var t=e.target.value;"number"===e.target.type&&t&&"undefined"!=typeof t&&(t=parseInt(t)),"select-one"===e.target.type&&(t="true"===t);var a=this.props.subnet;a[e.target.name]=t,a._edited=!0,this.props.change(this.props.index,a)}},{key:"handleOptionChange",value:function(e){var t=this.props.subnet;t.Options[e.target.name].Value=e.target.value,t._edited=!0,this.props.change(this.props.index,t)}},{key:"render",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.props.subnet));return React.createElement("tbody",{className:(t.updating?"updating-content":"")+" "+(t._expand?"expanded":"")+" "+(t._error?"error":t._new?"new":t._edited?"edited":"")},React.createElement("tr",null,React.createElement("td",null,t._new?React.createElement("input",{type:"text",name:"Name",size:"8",placeholder:"eth0",value:t.Name,onChange:this.handleChange}):t.Name),React.createElement("td",null,React.createElement("input",{type:"text",name:"Subnet",size:"15",placeholder:"192.168.1.1/24",value:t.Subnet,onChange:this.handleChange})),React.createElement("td",null,React.createElement("select",{name:"OnlyReservations",type:"bool",value:t.OnlyReservations,onChange:this.handleChange},React.createElement("option",{value:"true"},"Required"),React.createElement("option",{value:"false"},"Optional"))),React.createElement("td",null,React.createElement("input",{type:"number",name:"ActiveLeaseTime",style:{width:"50px"},placeholder:"0",value:t.ActiveLeaseTime,onChange:this.handleChange})," & ",React.createElement("input",{type:"number",name:"ReservedLeaseTime",style:{width:"50px"},placeholder:"7200",value:t.ReservedLeaseTime,onChange:this.handleChange})," seconds"),React.createElement("td",null,React.createElement("div",null,React.createElement("input",{type:"text",name:"ActiveStart",size:"15",placeholder:"10.0.0.0",value:t.ActiveStart,onChange:this.handleChange}),"..."),React.createElement("div",null,React.createElement("input",{type:"text",name:"ActiveEnd",size:"15",placeholder:"10.0.0.255",value:t.ActiveEnd,onChange:this.handleChange}))),React.createElement("td",{style:{border:"thin solid black !important"},className:"icon-buttons"},t._new||t._edited?React.createElement("button",{onClick:this.update,className:"icon-button"},"save",React.createElement("span",{className:"tooltip"},t._new?"Add":"Save")):"",React.createElement("button",{onClick:this.remove,className:"icon-button"},"delete",React.createElement("span",{className:"tooltip"},"Remove")),React.createElement("button",{onClick:this.props.copy,className:"icon-button"},"content_copy",React.createElement("span",{className:"tooltip"},"Copy")))),React.createElement("tr",null,React.createElement("td",{colSpan:"7"},t._expand?React.createElement("div",null,React.createElement("h2",null,"Other Values"),React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{style:{textAlign:"right",fontWeight:"bold"}},"Next Server"),React.createElement("td",null,React.createElement("input",{type:"text",name:"NextServer",size:"12",value:t.NextServer,onChange:this.handleChange}))))),React.createElement("h2",null,"Options"),React.createElement("table",null,React.createElement("tbody",null,t.Options.map(function(t,a){return React.createElement("tr",{key:a},React.createElement("td",{style:{textAlign:"right",fontWeight:"bold"}},e.getCodeName(t.Code)),React.createElement("td",null,React.createElement("input",{type:"text",name:a,value:t.Value,onChange:e.handleOptionChange})),React.createElement("td",null,"Option # ",t.Code))})))):React.createElement("span",null),t._error&&React.createElement("div",null,React.createElement("h2",null,React.createElement("span",{className:"material-icons"},"error"),t._errorMessage)),React.createElement("div",{className:"expand",onClick:this.toggleExpand},t._expand?React.createElement("span",{className:"material-icons"},"expand_less"):React.createElement("span",{className:"material-icons"},"expand_more")))))}}]),t}(React.Component),l=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={subnets:[],interfaces:[]},a.componentDidMount=a.componentDidMount.bind(a),a.update=a.update.bind(a),a.addSubnet=a.addSubnet.bind(a),a.updateSubnet=a.updateSubnet.bind(a),a.removeSubnet=a.removeSubnet.bind(a),a.changeSubnet=a.changeSubnet.bind(a),a}return c(t,e),o(t,[{key:"getSubnets",value:function(){return new Promise(function(e,t){var a={},n={};$.getJSON("../api/v3/interfaces",function(s){for(var c in s){var r=s[c];n[r.Name]=r}$.getJSON("../api/v3/subnets",function(t){for(var s in t){var c=t[s];a[c.Name]=c,void 0!=n[c.Name]&&delete n[c.Name]}e({interfaces:n,subnets:a})}).fail(function(){t("Failed getting subnets")})}).fail(function(){t("Failed getting interfaces")})})}},{key:"componentDidMount",value:function(){this.update()}},{key:"update",value:function(){var e=this;this.getSubnets().then(function(t){e.setState({subnets:Object.keys(t.subnets).map(function(e){return t.subnets[e]}),interfaces:Object.keys(t.interfaces).map(function(e){return t.interfaces[e]})})},function(e){})}},{key:"addSubnet",value:function(e){function t(e,t){for(var a=t.split("."),n=[],s=0;s<4;s++){var c=Math.min(e,8);a[s]&=256-Math.pow(2,8-c),n[s]=a[s]+Math.pow(2,8-c)-1,e-=c}return[a.join("."),n.join(".")]}var a,n;if(e.IP){var s=e.IP.indexOf("/");a=e.IP.substring(0,s);var c=parseInt(e.IP.split("/")[1]),n=t(c,a)}var r={_new:!0,Name:"",ActiveLeaseTime:60,ReservedLeaseTime:7200,OnlyReservations:!1,ActiveStart:a?n[0]:"",Subnet:"",ActiveEnd:a?n[1]:"",Strategy:"MAC",NextServer:a||"",Options:[{Code:3,Value:a||""},{Code:6,Value:a||""},{Code:15,Value:"example.com"},{Code:67,Value:"lpxelinux.0"}]};if("undefined"!=typeof e)for(var o in e)if("_"!==o[0])if("Options"===o)for(var i=0;i<e.Options.length;i++){var l=[3,6,15,67].indexOf(e.Options[i].Code);l>=0?r.Options[l].Value=e.Options[i].Value:r.Options.push(e.Options[i])}else r[o]=e[o];this.setState({subnets:this.state.subnets.concat(r)})}},{key:"updateSubnet",value:function(e){var t=this,a=this.state.subnets[e];a.updating=!0,this.setState({subnet:this.state.subnets}),$.ajax({type:a._new?"POST":"PUT",dataType:"json",contentType:"application/json",url:"/api/v3/subnets"+(a._new?"":"/"+a.Name),data:JSON.stringify(a)}).done(function(a){var n=t.state.subnets.concat([]);a.updating=!1,a._edited=!1,a._new=!1,a._error=!1,a._errorMessage="",n[e]=a;var s=t.state.interfaces.concat([]);for(var c in s)s[c].Name==a.Name&&s.splice(c);t.setState({subnets:n,interfaces:s})}).fail(function(a){var n=t.state.subnets.concat([]),s=n[e];if(s.updating=!1,s._error=!0,a.responseText){var c=JSON.parse(a.responseText);s._errorMessage=" ("+a.status+"): "+c.Messages.join(", ")}else s._errorMessage=a.status;t.setState({subnets:n})})}},{key:"removeSubnet",value:function(e){var t=this,a=this.state.subnets.concat([]),n=this.state.subnets[e];return n._new?(a.splice(e,1),void this.setState({subnets:a})):(a[e].updating=!0,this.setState({subnets:a}),void $.ajax({type:"DELETE",dataType:"json",contentType:"application/json",url:"/api/v3/subnets/"+n.Name}).done(function(a){var n=t.state.subnets.concat([]);n.splice(e,1),t.setState({subnets:n})}).fail(function(e){if(n.updating=!1,n._error=!0,e.responseText){var s=JSON.parse(e.responseText);n._errorMessage=" ("+e.status+"): "+s.Messages.join(", ")}else n._errorMessage=e.status;t.setState({subnets:a})}))}},{key:"changeSubnet",value:function(e,t){var a=this.state.subnets.concat([]);a[e]=t,this.setState({subnets:a})}},{key:"render",value:function(){var e=this;return $("#subnetCount").text(this.state.subnets.length),React.createElement("div",{id:"subnets"},React.createElement("h2",{style:{display:"flex",justifyContent:"space-between"}},React.createElement("span",{className:"section-head"},"Subnets"),React.createElement("span",null,React.createElement("a",{target:"_blank",href:"http://provision.readthedocs.io/en/latest/doc/ui.html#subnets"},"UI Help")," | ",React.createElement("a",{target:"_blank",href:"/swagger-ui/#/subnets"},"API Help"))),React.createElement("table",{className:"fullwidth input-table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name/NIC"),React.createElement("th",null,"Subnet"),React.createElement("th",null,"Reservations"),React.createElement("th",null,"Active & Reserved Lease"),React.createElement("th",null,"Range"),React.createElement("th",null))),this.state.subnets.map(function(t,a){return React.createElement(i,{subnet:t,update:e.updateSubnet,change:e.changeSubnet,remove:e.removeSubnet,copy:function(){return e.addSubnet(e.state.subnets[a])},key:a,index:a})}),React.createElement("tfoot",null,React.createElement("tr",null,React.createElement("td",{colSpan:"7",style:{textAlign:"center"}},React.createElement("button",{onClick:function(){return e.addSubnet({})}},"New Subnet"))))),React.createElement("h2",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},React.createElement("span",null,"Available Interfaces: "),React.createElement("span",{className:"interface-list"},this.state.interfaces.map(function(t){return t.Addresses.map(function(a,n){return React.createElement("a",{key:t.Name+"-"+n,className:"interface-pair",onClick:function(){return e.addSubnet({Name:t.Name,Subnet:a,Interface:t.Name,IP:a})}},React.createElement("header",null,t.Name),React.createElement("subhead",null,a))})}))))}}]),t}(React.Component),u=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.xhr=void 0,a.STATES={STANDBY:0,WAITING:1,AUTHORIZED:2,DONE:3,ERROR:4},a.icons=["mood","hourglass_empty","security","done_all","close"],a.messages=["","Signing In","Getting Token","Done!","Error"],a.state={token:"",username:"",password:"",useToken:!1,code:1,requestState:a.STATES.STANDBY},a.handleChange=a.handleChange.bind(a),a.setToken=a.setToken.bind(a),a}return c(t,e),o(t,[{key:"getCodeName",value:function(){var e={0:"API Unreachable",1:" ",200:"Granted",401:"No Credentials/Token",403:"Invalid Credentials/Token"};return e[this.state.code]||"Code "+this.state.code}},{key:"componentDidMount",value:function(){if(location.search.startsWith("?token=")){var e=location.search.substring(7);this.setState({token:e,useToken:!0}),this.setToken(e)}else localStorage.DrAuthToken&&(this.setState({useToken:!0}),this.setToken(localStorage.DrAuthToken))}},{key:"setToken",value:function(e){var t=[],a="Bearer "+e,n=this;e.includes(":")?a="Basic "+btoa(e):localStorage.DrAuthToken=e,console.log(e),"undefined"!=typeof this.xhr&&(this.xhr.abort(),this.xhr=void 0),$.ajaxSetup({headers:{Authorization:a}}),this.xhr=$.ajax({url:"../api/v3/bootenvs",type:"GET",async:!0}).then(function(a){for(var s in a)a[s].Available&&t.push(a[s].Name);if(e.includes(":")){n.setState({requestState:n.STATES.AUTHORIZED});var c=e.split(":")[0];n.xhr=$.ajax({url:"../api/v3/users/"+c+"/token?ttl=28800",type:"GET",dataType:"json",async:!0,success:function(e){localStorage.DrAuthToken=e.Token,$.ajaxSetup({headers:{Authorization:"Bearer "+e.Token}}),n.setState({code:200,requestState:n.STATES.DONE}),n.xhr=void 0,n.props.onAccessChange(!0,t)},error:function(e,t,a){n.xhr=void 0,n.setState({code:e.status,requestState:n.STATES.ERROR}),localStorage.DrAuthToken="",n.props.onAccessChange(!1,[])}})}else n.xhr=void 0,n.setState({code:200,requestState:n.STATES.DONE}),n.props.onAccessChange(!0,t)},function(e,a,s){localStorage.DrAuthToken="",n.xhr=void 0,console.log(s),n.setState({code:e.status,requestState:n.STATES.ERROR}),n.props.onAccessChange(!1,t)})}},{key:"handleChange",value:function(e){var t=this.state;t.requestState=this.STATES.WAITING,t[e.target.name]=e.target.value,this.setState(t);var a=this.state.useToken?this.state.token:this.state.username+":"+this.state.password;clearTimeout(this.tokenTimeout);var n=this.setToken;this.tokenTimeout=setTimeout(function(){n(a)},500)}},{key:"render",value:function(){var e=this,t=this;return React.createElement("div",null,React.createElement("div",{className:"login-box"},React.createElement("div",{className:"tabs"},React.createElement("div",{className:"tab "+(this.state.useToken?"":"active"),onClick:function(){return e.setState({useToken:!1})}},React.createElement("i",{className:"material-icons"},"person"),"Login"),React.createElement("div",{className:"tab "+(this.state.useToken?"active":""),onClick:function(){return e.setState({useToken:!0})}},React.createElement("i",{className:"material-icons"},"vpn_key"),"Token")),this.state.useToken?React.createElement("div",{className:"login-inputs"},React.createElement("div",{className:"login-input"},React.createElement("input",{type:"text",name:"token",size:"15",placeholder:"Token",value:this.state.token,onChange:this.handleChange}),React.createElement("i",{className:"material-icons"},"vpn_key")),React.createElement("div",{className:"login-hint"},React.createElement("span",null,"Tokens are generated via the "),React.createElement("a",{target:"_blank",href:"http://provision.readthedocs.io/en/stable/doc/cli/drpcli_users_token.html"},"drpcli binary"),React.createElement("span",null," or API"))):React.createElement("div",{className:"login-inputs"},React.createElement("div",{className:"login-input"},React.createElement("input",{type:"text",name:"username",size:"15",placeholder:"Username",value:this.state.username,onChange:this.handleChange}),React.createElement("i",{className:"material-icons"},"person")),React.createElement("div",{className:"login-input"},React.createElement("input",{type:"password",name:"password",size:"15",placeholder:"Password",value:this.state.password,onChange:this.handleChange}),React.createElement("i",{className:"material-icons"},"lock")),React.createElement("div",{className:"login-hint"},React.createElement("span",null,"Default credentials are "),React.createElement("code",{style:{textDecoration:"underline",color:"#547f00",cursor:"pointer"},onClick:function(){t.setState({username:"rocketskates",password:"r0cketsk8ts"}),t.setToken("rocketskates:r0cketsk8ts")}},"rocketskates:r0cketsk8ts"))),React.createElement("div",{style:{padding:"10px",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement("i",{className:"material-icons"},this.icons[this.state.requestState]),this.state.requestState==this.STATES.ERROR?React.createElement("span",{style:{color:"#a00"}},this.getCodeName()):React.createElement("span",null,this.messages[this.state.requestState]))),React.createElement("div",{className:"welcome-box"},React.createElement("h1",null,"Welcome to Digital Rebar: Provision"),React.createElement("p",{className:"description"},React.createElement("strong",null,"DR Provision ")," is a APLv2 simple Golang executable that provides a simple yet complete API-driven DHCP/PXE/TFTP provisioning system. It is designed to stand alone or operate as part of the ",React.createElement("a",{href:"http://rebar.digital/",target:"_blank"},"Digital Rebar")," management system. Check out some of the links below for more information!"),React.createElement("div",{className:"welcome-menu"},[{name:"Resources",links:[{name:"Introduction",href:"",icon:"book"},{name:"Documentation",href:"http://provision.readthedocs.io/en/stable/",icon:"info"},{name:"Videos",href:"https://www.youtube.com/playlist?list=PLXPBeIrpXjfilUi7Qj1Sl0UhjxNRSC7nx",icon:"video_library"}]},{name:"Support",links:[{name:"Gitter",href:"https://gitter.im/digitalrebar/core",icon:"forum"},{name:"IRC (Freenode)",href:"https://webchat.freenode.net/?channels=%23digitalrebar&uio=d4",icon:"chat"},{name:"Mailing List",href:"https://groups.google.com/forum/#!forum/digitalrebar",icon:"mail"}]},{name:"Project",links:[{name:"Contribute",href:"https://github.com/digitalrebar/provision",icon:"code"},{name:"Issues Tracker",href:"https://github.com/digitalrebar/provision/issues",icon:"directions"}]}].map(function(e){return React.createElement("section",null,React.createElement("header",null,e.name),React.createElement("article",null,e.links.map(function(e){return React.createElement("a",{href:e.href,target:"_blank","class":"welcome-link"},React.createElement("i",{className:"material-icons"},e.icon),React.createElement("span",null,e.name))})))}))))}}]),t}(React.Component),p=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.toggleExpand=a.toggleExpand.bind(a),a.handleChange=a.handleChange.bind(a),a.update=a.update.bind(a),a.remove=a.remove.bind(a),a}return c(t,e),o(t,[{key:"toggleExpand",value:function(){var e=this.props.machine;e._expand=!e._expand,this.props.change(this.props.index,e)}},{key:"update",value:function(){this.props.update(this.props.index)}},{key:"remove",value:function(){this.props.remove(this.props.index)}},{key:"handleChange",value:function(e){var t=e.target.value,a=this.props.machine;a[e.target.name]=t,a._edited=!0,this.props.change(this.props.index,a)}},{key:"render",value:function(){var e=JSON.parse(JSON.stringify(this.props.machine));return React.createElement("tbody",{className:(e.updating?"updating-content":"")+" "+(e._expand?"expanded":"")+" "+(e._error?"error":e._new?"new":e._edited?"edited":"")},React.createElement("tr",null,React.createElement("td",null,React.createElement("input",{type:"text",name:"Name",size:"15",placeholder:"name.example.com",value:e.Name,onChange:this.handleChange})),React.createElement("td",null,React.createElement("input",{type:"text",name:"Address",size:"15",placeholder:"0.0.0.0",value:e.Address,onChange:this.handleChange})),React.createElement("td",null,React.createElement("select",{name:"BootEnv",type:"bool",value:e.BootEnv,onChange:this.handleChange},this.props.bootenvs.map(function(e){return React.createElement("option",{key:e,value:e},e)}))),React.createElement("td",null,React.createElement("input",{type:"text",name:"Description",size:"15",placeholder:"",value:e.Description,onChange:this.handleChange})),React.createElement("td",null,e.Uuid?React.createElement("div",{title:e.Uuid},e.Uuid.slice(0,4),"...",e.Uuid.slice(-4)):"not set"),React.createElement("td",{className:"icon-buttons"},e._new||e._edited?React.createElement("button",{onClick:this.update,className:"icon-button"},"save",React.createElement("span",{className:"tooltip"},e._new?"Add":"Save")):"",React.createElement("button",{onClick:this.remove,className:"icon-button"},"delete",React.createElement("span",{className:"tooltip"},"Remove")))),React.createElement("tr",null,React.createElement("td",{colSpan:"6"},e._expand?React.createElement("div",null,e._error&&React.createElement("div",null,React.createElement("h2",null,React.createElement("span",{className:"material-icons"},"error"),e._errorMessage)),React.createElement("h2",null,"Template Errors"),e.Errors?machines.Errors:"none.",React.createElement("h2",null,"Template Params"),e.Params?machines.Params:"none."):React.createElement("span",null),React.createElement("div",{className:"expand",onClick:this.toggleExpand},e._expand?React.createElement("span",{className:"material-icons"},"expand_less"):React.createElement("span",{className:"material-icons"},"expand_more")))))}}]),t}(React.Component),m=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={machines:[]},a.componentDidMount=a.componentDidMount.bind(a),a.update=a.update.bind(a),a.addMachine=a.addMachine.bind(a),a.changeMachine=a.changeMachine.bind(a),a.removeMachine=a.removeMachine.bind(a),a.updateMachine=a.updateMachine.bind(a),a}return c(t,e),o(t,[{key:"getMachines",value:function(){return new Promise(function(e,t){$.getJSON("../api/v3/machines",function(t){e({machines:t})}).fail(function(){t("Failed getting Machines")})})}},{key:"componentDidMount",value:function(){this.update()}},{key:"update",value:function(){var e=this;this.getMachines().then(function(t){e.setState({machines:t.machines})},function(e){})}},{key:"addMachine",value:function(){var e={Name:"",Address:"0.0.0.0",BootEnv:"ignore",Description:"",Uuid:null,_new:!0};this.setState({machines:this.state.machines.concat(e)})}},{key:"updateMachine",value:function(e){var t=this,a=this.state.machines[e];a.updating=!0,this.setState({machine:this.state.machines}),$.ajax({type:a._new?"POST":"PUT",dataType:"json",contentType:"application/json",url:"/api/v3/machines"+(a._new?"":"/"+a.Uuid),data:JSON.stringify(a)}).done(function(a){var n=t.state.machines.concat([]);a.updating=!1,a._edited=!1,a._new=!1,a._error=!1,a._errorMessage="",n[e]=a,t.setState({machines:n})}).fail(function(a){var n=t.state.machines.concat([]),s=n[e];if(s.updating=!1,s._error=!0,s._expand=!0,a.responseText){var c=JSON.parse(a.responseText);s._errorMessage=" ("+a.status+"): "+c.Messages.join(", ")}else s._errorMessage=a.status;t.setState({machines:n})})}},{key:"removeMachine",value:function(e){var t=this,a=this.state.machines.concat([]),n=this.state.machines[e];return n._new?(a.splice(e,1),void this.setState({machines:a})):(a[e].updating=!0,void $.ajax({type:"DELETE",dataType:"json",contentType:"application/json",url:"/api/v3/machines/"+n.Uuid}).done(function(a){var n=t.state.machines.concat([]);n.splice(e,1),t.setState({machines:n})}).fail(function(e){if(n.updating=!1,n._error=!0,e.responseText){var s=JSON.parse(e.responseText);n._errorMessage=" ("+e.status+"): "+s.Messages.join(", ")}else n._errorMessage=e.status;t.setState({machines:a})}))}},{key:"changeMachine",value:function(e,t){var a=this.state.machines.concat([]);a[e]=t,this.setState({machines:a})}},{key:"render",value:function(){var e=this;return $("#machineCount").text(this.state.machines.length),React.createElement("div",{id:"machines"},React.createElement("h2",{style:{display:"flex",justifyContent:"space-between"}},React.createElement("span",{className:"section-head"},"Machines"),React.createElement("span",null,React.createElement("a",{target:"_blank",href:"http://provision.readthedocs.io/en/latest/doc/ui.html#machines"},"UI Help")," | ",React.createElement("a",{target:"_blank",href:"/swagger-ui/#/machines"},"API Help"))),React.createElement("table",{className:"fullwidth input-table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Address"),React.createElement("th",null,"BootEnv"),React.createElement("th",null,"Description"),React.createElement("th",null,"Uuid"),React.createElement("th",null))),this.state.machines.map(function(t,a){return React.createElement(p,{machine:t,bootenvs:e.props.bootenvs,update:e.updateMachine,change:e.changeMachine,remove:e.removeMachine,key:a,index:a})}),React.createElement("tfoot",null,React.createElement("tr",null,React.createElement("td",{colSpan:"6",style:{textAlign:"center"}},React.createElement("button",{onClick:function(){return e.addMachine({})}},"New Machine"))))))}}]),t}(React.Component),d=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={prefs:{},updated:!1},a.componentDidMount=a.componentDidMount.bind(a),a.update=a.update.bind(a),a.changePrefs=a.changePrefs.bind(a),a.updatePrefs=a.updatePrefs.bind(a),a.handleChange=a.handleChange.bind(a),a}return c(t,e),o(t,[{key:"getPrefs",value:function(){return new Promise(function(e,t){$.getJSON("../api/v3/prefs",function(t){e({prefs:t})}).fail(function(){t("Failed getting Prefs")})})}},{key:"componentDidMount",value:function(){this.update()}},{key:"update",value:function(){var e=this;this.getPrefs().then(function(t){e.setState({prefs:t.prefs})},function(e){})}},{key:"updatePrefs",value:function(){var e=this,t=this.state.prefs;$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"/api/v3/prefs",data:JSON.stringify(t)}).done(function(a){e.setState({prefs:t,updated:!1})}).fail(function(t){e.onAccessChange(!1)})}},{key:"changePrefs",value:function(e,t){var a=this.state.prefs;a[e]=t,this.setState({prefs:a,updated:!0})}},{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value;this.changePrefs(t,a)}},{key:"render",value:function(){var e=this;return React.createElement("div",null,React.createElement("h2",{style:{display:"flex",justifyContent:"space-between"}},React.createElement("span",{className:"section-head"},"Preferences"),React.createElement("span",null,React.createElement("a",{target:"_blank",href:"http://provision.readthedocs.io/en/latest/doc/ui.html#prefs"},"UI Help")," | ",React.createElement("a",{target:"_blank",href:"/swagger-ui/#/prefs"},"API Help"))),React.createElement("table",{className:"fullwidth input-table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Value"),React.createElement("th",null))),React.createElement("tbody",null,Object.keys(this.state.prefs).map(function(t,a){return React.createElement("tr",{key:a},React.createElement("td",null,t),React.createElement("td",null,t.indexOf("BootEnv")>0&&"debugBootEnv"!=t?React.createElement("select",{name:t,type:"bool",value:e.state.prefs[t],onChange:e.handleChange},e.props.bootenvs.map(function(e){return React.createElement("option",{key:e,value:e},e)})):React.createElement("input",{type:"text",name:t,size:"10",value:e.state.prefs[t],onChange:e.handleChange})),React.createElement("td",{className:"icon-buttons"},e.state.updated&&Object.keys(e.state.prefs).length-1==a?React.createElement("button",{onClick:e.updatePrefs,className:"icon-button"},"save",React.createElement("span",{className:"tooltip"},"Save")):""))}))))}}]),t}(React.Component),h=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.toggleExpand=a.toggleExpand.bind(a),a.handleChange=a.handleChange.bind(a),a.update=a.update.bind(a),a.remove=a.remove.bind(a),a.changeTemplate=a.changeTemplate.bind(a),a.addTemplate=a.addTemplate.bind(a),a.removeTemplate=a.removeTemplate.bind(a),a}return c(t,e),o(t,[{key:"toggleExpand",value:function(){var e=this.props.bootenv;e._expand=!e._expand,this.props.change(this.props.index,e)}},{key:"update",value:function(){this.props.update(this.props.index)}},{key:"remove",value:function(){this.props.remove(this.props.index)}},{key:"handleChange",value:function(e){var t=e.target.value;"number"===e.target.type&&t&&"undefined"!=typeof t&&(t=parseInt(t));var a=this.props.bootenv;a[e.target.name]=t,a._edited=!0,this.props.change(this.props.index,a)}},{key:"changeTemplate",value:function(e,t){this.props.bootenv.Templates[t][e.target.name]=e.target.value,this.props.bootenv._edited=!0,this.props.change(this.props.index,this.props.bootenv)}},{key:"addTemplate",value:function(e){this.props.bootenv.Templates.push({Name:"",Path:"",ID:""}),this.props.bootenv._edited=!0,this.props.change(this.props.index,this.props.bootenv)}},{key:"removeTemplate",value:function(e,t){this.props.bootenv.Templates.splice(t,1),this.props.bootenv._edited=!0,this.props.change(this.props.index,this.props.bootenv)}},{key:"render",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.props.bootenv));return React.createElement("tbody",{className:(t.updating?"updating-content":"")+" "+(t._expand?"expanded":"")+" "+(t._error?"error":t._new?"new":t._edited?"edited":"")},React.createElement("tr",null,React.createElement("td",null,t._new?React.createElement("input",{type:"text",name:"Name",size:"8",placeholder:"eth0",value:t.Name,onChange:this.handleChange}):t.Name),React.createElement("td",null,t.Available?"Yes":"Error"),React.createElement("td",null,React.createElement("a",{href:t.OS.IsoUrl},t.OS.IsoFile)),React.createElement("td",{className:"icon-buttons"},t._new||t._edited?React.createElement("button",{onClick:this.update,className:"icon-button"},"save",React.createElement("span",{className:"tooltip"},t._new?"Add":"Save")):"",React.createElement("button",{onClick:this.remove,className:"icon-button"},"delete",React.createElement("span",{className:"tooltip"},"Remove")),React.createElement("button",{onClick:this.props.copy,className:"icon-button"},"content_copy",React.createElement("span",{className:"tooltip"},"Copy")))),React.createElement("tr",null,React.createElement("td",{colSpan:"7"},t._expand?React.createElement("div",null,React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{style:{textAlign:"right",fontWeight:"bold"}},"Iso Name"),React.createElement("td",null,React.createElement("input",{type:"text",size:"30",value:t.OS.IsoFile,onChange:function(a){t._edited=!0,t.OS.IsoFile=a.target.value,e.props.change(e.props.index,t)}}))),React.createElement("tr",null,React.createElement("td",{style:{textAlign:"right",fontWeight:"bold"}},"Iso URL"),React.createElement("td",null,React.createElement("input",{type:"text",size:"30",value:t.OS.IsoUrl,onChange:function(a){t._edited=!0,t.OS.IsoUrl=a.target.value,
e.props.change(e.props.index,t)}}))))),React.createElement("h2",null,"Templates"),React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Path"),React.createElement("th",null,"ID"),React.createElement("th",null))),React.createElement("tbody",null,t.Templates.map(function(t,a){return React.createElement("tr",{key:a},React.createElement("td",null,React.createElement("input",{type:"text",size:"15",name:"Name",value:t.Name,onChange:function(t){return e.changeTemplate(t,a)}})),React.createElement("td",null,React.createElement("input",{type:"text",size:"30",name:"Path",value:t.Path,onChange:function(t){return e.changeTemplate(t,a)}})),React.createElement("td",null,React.createElement("input",{type:"text",size:"20",name:"ID",value:t.ID,onChange:function(t){return e.changeTemplate(t,a)}})),React.createElement("td",{className:"icon-buttons"},React.createElement("button",{onClick:function(a){return $.getJSON("../api/v3/templates/"+t.ID,e.props.preview)},className:"icon-button"},"open_in_new",React.createElement("span",{className:"tooltip"},"Preview")),React.createElement("button",{onClick:function(t){return e.removeTemplate(t,a)},className:"icon-button"},"delete",React.createElement("span",{className:"tooltip"},"Remove"))))}),React.createElement("tr",null,React.createElement("td",{colSpan:"4",style:{textAlign:"center"}},React.createElement("button",{onClick:this.addTemplate},"Add Template")))))):React.createElement("span",null),t._error&&React.createElement("div",null,React.createElement("h2",null,React.createElement("span",{className:"material-icons"},"error"),t._errorMessage)),React.createElement("div",{className:"expand",onClick:this.toggleExpand},t._expand?React.createElement("span",{className:"material-icons"},"expand_less"):React.createElement("span",{className:"material-icons"},"expand_more")))))}}]),t}(React.Component),v=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={bootenvs:[],templatePreview:void 0},a.componentDidMount=a.componentDidMount.bind(a),a.update=a.update.bind(a),a.addBootEnv=a.addBootEnv.bind(a),a.updateBootEnv=a.updateBootEnv.bind(a),a.removeBootEnv=a.removeBootEnv.bind(a),a.changeBootEnv=a.changeBootEnv.bind(a),a.previewTemplate=a.previewTemplate.bind(a),a}return c(t,e),o(t,[{key:"getBootEnvs",value:function(){return new Promise(function(e,t){$.getJSON("../api/v3/bootenvs",function(t){e({bootenvs:t})}).fail(function(e){t("Failed getting BootEnvs")})})}},{key:"previewTemplate",value:function(e){this.setState({templatePreview:e})}},{key:"componentDidMount",value:function(){this.update()}},{key:"update",value:function(){var e=this;this.getBootEnvs().then(function(t){e.setState({bootenvs:t.bootenvs,templatePreview:void 0})},function(e){})}},{key:"addBootEnv",value:function(e){var t={_new:!0,Name:"",Description:"",OS:{Name:"",Family:"",Codename:"",Version:"",IsoFile:"",IsoSha256:"",IsoUrl:""},Templates:[],Kernel:"",Initrds:[],RequiredParams:[],Available:!0,Errors:[]};if("undefined"!=typeof e)for(var a in e)"_"!==a[0]&&(t[a]=e[a]);this.setState({bootenvs:this.state.bootenvs.concat(t)})}},{key:"updateBootEnv",value:function(e){var t=this,a=this.state.bootenvs[e];a.updating=!0,this.setState({bootenv:this.state.bootenvs}),$.ajax({type:a._new?"POST":"PUT",dataType:"json",contentType:"application/json",url:"/api/v3/bootenvs"+(a._new?"":"/"+a.Name),data:JSON.stringify(a)}).done(function(a){var n=t.state.bootenvs.concat([]);a.updating=!1,a._edited=!1,a._new=!1,a._error=!1,a._errorMessage="",n[e]=a,t.setState({bootenvs:n})}).fail(function(a){var n=t.state.bootenvs.concat([]),s=n[e];if(s.updating=!1,s._error=!0,a.responseText){var c=JSON.parse(a.responseText);s._errorMessage=" ("+a.status+"): "+c.Messages.join(", ")}else s._errorMessage=a.status;t.setState({bootenvs:n})})}},{key:"removeBootEnv",value:function(e){var t=this,a=this.state.bootenvs.concat([]),n=this.state.bootenvs[e];return n._new?(a.splice(e,1),void this.setState({bootenvs:a})):(a[e].updating=!0,this.setState({bootenvs:a}),void $.ajax({type:"DELETE",dataType:"json",contentType:"application/json",url:"/api/v3/bootenvs/"+n.Name}).done(function(a){var n=t.state.bootenvs.concat([]);n.splice(e,1),t.setState({bootenvs:n})}).fail(function(e){if(n.updating=!1,n._error=!0,e.responseText){var s=JSON.parse(e.responseText);n._errorMessage=" ("+e.status+"): "+s.Messages.join(", ")}else n._errorMessage=e.status;t.setState({bootenvs:a})}))}},{key:"changeBootEnv",value:function(e,t){var a=this.state.bootenvs.concat([]);a[e]=t,this.setState({bootenvs:a})}},{key:"render",value:function(){var e=this;return $("#bootenvCount").text(this.state.bootenvs.length),React.createElement("div",{id:"bootenvs"},React.createElement("h2",{style:{display:"flex",justifyContent:"space-between"}},React.createElement("span",{className:"section-head"},"Boot Environments"),React.createElement("span",null,React.createElement("a",{target:"_blank",href:"http://provision.readthedocs.io/en/latest/doc/ui.html#bootenvs"},"UI Help")," | ",React.createElement("a",{target:"_blank",href:"/swagger-ui/#/bootenvs"},"API Help"))),React.createElement("table",{className:"fullwidth input-table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Environment"),React.createElement("th",null,"Available"),React.createElement("th",null,"Path"),React.createElement("th",null))),this.state.bootenvs.map(function(t,a){return React.createElement(h,{bootenv:t,update:e.updateBootEnv,change:e.changeBootEnv,remove:e.removeBootEnv,preview:e.previewTemplate,copy:function(){return e.addBootEnv(e.state.bootenvs[a])},key:a,index:a})}),React.createElement("tfoot",null,React.createElement("tr",null,React.createElement("td",{colSpan:"4",style:{textAlign:"center"}},React.createElement("button",{onClick:function(){return e.addBootEnv({})}},"New BootEnv"))))),this.state.templatePreview&&React.createElement("div",{className:"card floating overlay"},React.createElement("div",{className:"card-toolbar"},React.createElement("h2",null,this.state.templatePreview.ID||"No ID Set"),React.createElement("button",{onClick:function(){return e.setState({templatePreview:void 0})},className:"icon-button flat"},"close")),React.createElement("div",{className:"card-content"},React.createElement("pre",null,this.state.templatePreview.Contents||"No Content"))))}}]),t}(React.Component),f=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={access:!1,tab:localStorage.DrLastTab||"subnets",bootenvs:[]},a.onAccessChange=a.onAccessChange.bind(a),a.update=a.update.bind(a),a.setTab=a.setTab.bind(a),a}return c(t,e),o(t,[{key:"setTab",value:function(e){localStorage.DrLastTab=e,this.setState({tab:e})}},{key:"componentDidMount",value:function(){}},{key:"update",value:function(e){r(e);var t=this;console.log("Updating"),console.log(this),$.getJSON("../api/v3/bootenvs",function(e){var a=[];for(var n in e)e[n].Available&&a.push(e[n].Name);t.setState({bootenvs:a},function(){return _.each(t.refs,function(e){return e.update()})})}).fail(function(){})}},{key:"onAccessChange",value:function(e,t){this.setState({access:e,bootenvs:t})}},{key:"render",value:function(){var e=this,t=this.state.access,a=this.state.bootenvs;return $("#navcontrols").css("display",t?"flex":"none"),t?React.createElement("div",{id:"swagger-ui-container",className:"swagger-ui-wrap"},React.createElement("div",{className:"tabs"},React.createElement("div",{className:"tab "+("subnet"===this.state.tab?"active":""),onClick:function(){return e.setTab("subnet")}},React.createElement("i",{className:"material-icons"},"device_hub"),"Subnets (",React.createElement("span",{id:"subnetCount"},"0"),")"),React.createElement("div",{className:"tab "+("bootenv"===this.state.tab?"active":""),onClick:function(){return e.setTab("bootenv")}},React.createElement("i",{className:"material-icons"},"album"),"Bootenvs (",React.createElement("span",{id:"bootenvCount"},"0"),")"),React.createElement("div",{className:"tab "+("machine"===this.state.tab?"active":""),onClick:function(){return e.setTab("machine")}},React.createElement("i",{className:"material-icons"},"dns"),"Machines (",React.createElement("span",{id:"machineCount"},"0"),")")),React.createElement("div",{style:{display:"subnet"===this.state.tab?"block":"none"}},React.createElement(l,{ref:"subnets",onAccessChange:this.onAccessChange})),React.createElement("div",{style:{display:"bootenv"===this.state.tab?"block":"none"}},React.createElement(v,{ref:"bootenvs",onAccessChange:this.onAccessChange}),React.createElement("hr",null),React.createElement(d,{ref:"prefs",bootenvs:a,onAccessChange:this.onAccessChange})),React.createElement("div",{style:{display:"machine"===this.state.tab?"block":"none"}},React.createElement(m,{ref:"machines",bootenvs:a,onAccessChange:this.onAccessChange}))):React.createElement("div",null,React.createElement("center",null,React.createElement(u,{access:t,onAccessChange:this.onAccessChange})))}}]),t}(React.Component);window.Provisioner=ReactDOM.render(React.createElement(f,null),document.getElementById("page"))}),require.register("___globals___",function(e,t,a){})}(),require("___globals___");
